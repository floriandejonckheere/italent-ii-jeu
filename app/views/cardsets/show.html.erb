<%= link_to new_cardset_card_path(@cardset), :class => "btn btn-fab btn-raised btn-material-blue btn-navbar" do %>
  <i class="mdi-content-add text-white"></i>
<% end %>

<div class="row row-animated">
  <div class="col-lg-8 col-lg-offset-2">
  <h2><%= @cardset.title %> <small><%= pluralize(@cardset.cards.size, t('card')) %></small></h2>
  <% if Category.all.size != 0 %>
    <% if @cardset.cards.size != 0 %>
    <% Category.all.each do |category| %>
      <% if @cardset.cards.where(:category_id => category.id).any? %>
      <h5>
        <span class="pull-right">
          <%= link_to cardset_category_path(@cardset, category), :class => "link-icon" do %>
            <i class="mdi-action-view-carousel" data-toggle="tooltip" data-placement="top" title="<%= t('action_presentation') %>"></i>
          <% end %>
        </span>
        <%= category.title %> <small><%= pluralize(@cardset.cards.where(:category_id => category.id).size, t('card')) %></small>
      </h5>
      <div class="row">
        <div class="col-xs-12">
          <div class="panel">
            <div class="panel-body panel-list">
              <% ellipsis = false %>
              <% @cardset.cards.where(:category_id => category.id).each_with_index do |card, n| %>
              <% if ((n > 2) && (n != (@cardset.cards.where(:category_id => category.id).size - 1))) %>
                <% if !ellipsis %>
                  <% ellipsis = true %>
                  <div class="row text-center">
                    <a href="javascript:void(0);" onClick="$(this).parent().slideUp(200, function(){$(this).siblings('.row-collapsed').slideToggle();});" class="link-icon"><i class="mdi-navigation-more-vert"></i></a>
                  </div>
                <% end %>
              <div class="row row-collapsed">
              <% else %>
              <div class="row">
              <% end %>
                <div class="col-xs-1">
                  <img class="img-circle icon-xs" src="http://lorempixel.com/56/56/people/1" alt="icon">
                </div>
                <div class="col-xs-9">
                  <strong><%= link_to truncate(card.question, length: 50), edit_cardset_card_path(:id => card, :cardset_id => @cardset), :class => "link-black" %></strong>
                </div>
                <div class="col-xs-2">
                  <div class="pull-right">
                    <%= link_to edit_cardset_card_path(:id => card, :cardset_id => @cardset), :class => "link-icon", :data => {:toggle => "tooltip", :placement => "bottom"}, :title => t('action_edit') do %>
                      <i class="mdi-content-create"></i>
                    <% end %>
                    <%= link_to cardset_card_path(:id => card, :cardset_id => @cardset), method: :delete,
                                data: { confirm: t('text_confirmdelete') }, :class => "link-icon", :data => {:toggle => "tooltip", :placement => "bottom"}, :title => t('action_delete') do %>
                      <i class="mdi-action-delete"></i>
                    <% end %>
                  </div>
                </div>
              </div>
              <% end %>
            </div>
          </div>
        </div>
      </div>
      <% end %>
    <% end %>
    <% else %>
    <div class="alert alert-warning">
      <h4><%= t('title_nocards') %></h4>
      <p><%= t('text_nocards') %> <strong><%= link_to t('link_nocards'), new_cardset_card_path(@cardset) %></strong></p>
    </div>
    <% end %>
  <% else %>
  <div class="alert alert-warning">
      <h4><%= t('title_nocategories') %></h4>
      <p><%= t('text_nocategories') %> <strong><%= link_to t('link_nocategories'), new_category_path %></strong></p>
  </div>
  <% end %>
  </div>
</div>
